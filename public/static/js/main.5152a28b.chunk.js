(this["webpackJsonpreact-admin-client"]=this["webpackJsonpreact-admin-client"]||[]).push([[0],{1257:function(e,t,a){},1258:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(11),c=a.n(o),l=a(16),s=a(17),i=a(19),u=a(18),m=a(20),p=a(107),d=a(122),h=(a(69),a(29)),f=(a(89),a(44)),g=(a(125),a(5)),y=a(23),b=a.n(y),v=(a(101),a(37)),E=a(36),O=(a(126),a(38)),k=(a(574),a(254)),w=a.n(k),j={user:{}},C=a(268),S=a.n(C),x=function(e){S.a.set("user_key",e)},N=function(){return S.a.get("user_key")||{}},I=function(){S.a.remove("user_key")},M=a(540),A=a(351),P=a.n(A);function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(n,r){("GET"===a?P.a.get(e,{params:t}):P.a.post(e,t)).then((function(e){n(e.data)})).catch((function(e){v.a.error("\u8bf7\u6c42\u51fa\u9519\u4e86"+e.message)}))}))}var D=a(542),_=a.n(D),F=function(e,t){return T("/login",{username:e,password:t},"POST")},R=function(e){return new Promise((function(t,a){var n="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=3p49MVra6urFRGOT9s8UBWr2");_()(n,{},(function(e,a){if(console.log("jsonp",e,a),e||"success"!==a.status)v.a.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25");else{var n=a.results[0].weather_data[0],r=n.dayPictureUrl,o=n.weather,c=n.temperature;t({dayPictureUrl:r,weather:o,temperature:c})}}))}))},z=function(e){return T("/manager/category/list",{parentId:e})},U=function(e,t){return T("/manager/category/add",{categoryName:e,parentId:t},"POST")},L=function(e){return T("/manager/category/update",{categoryId:e.categoryId,categoryName:e.categoryName},"POST")},V=function(e,t){return T("/manager/product/list",{pageNum:e,pageSize:t})},W=function(e){var t=e.pageNum,a=e.pageSize,n=e.searchName,r=e.searchType;return T("/manager/product/search",Object(M.a)({pageNum:t,pageSize:a},r,n))},B=function(e){return T("/manager/category/info",{categoryId:e})},K=function(e,t){return T("/manager/product/updateStatus",{productId:e,status:t},"POST")},q=function(e){return T("/manager/img/delete",{name:e},"POST")},Y=function(e){return T("/manager/product/"+(e._id?"update":"add"),e,"POST")},J=function(e){return T("/manager/role/add",{roleName:e},"POST")},G=function(e){return T("/manager/role/update",e,"POST")},H=function(){return T("/manager/user/list")},Q=function(e){return T("/manager/user/delete",{userId:e},"POST")},X=function(e){return T("/manager/user/"+(e._id?"update":"add"),e,"POST")},Z=O.a.Item,$=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault();var t=a.props.form,n=t.getFieldsValue();console.log("handleSubmit: ",n),t.validateFields(function(){var e=Object(E.a)(b.a.mark((function e(t,n){var r,o,c,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return r=n.username,o=n.password,e.next=4,F(r,o);case 4:0===(c=e.sent).status?(v.a.success("\u767b\u5f55\u6210\u529f\uff01"),l=c.data,j.user=l,x(l),a.props.history.replace("/")):v.a.error(c.msg),e.next=9;break;case 8:console.log("\u6821\u9a8c\u5931\u8d25!");case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.validatorPWD=function(e,t,a){console.log("validatorPWD\u9a8c\u8bc1\uff1a",e,t),t?t.length<5?a("\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e4\u4f4d"):t.length>14?a("\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u5927\u4e8e13\u4f4d"):/^[a-zA-Z0-9_]+$/.test(t)?a():a("\u5bc6\u7801\u5fc5\u987b\u662f\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"):a("\u8bf7\u8f93\u5165\u5bc6\u7801...")},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=j.user;if(e&&e._id)return r.a.createElement(d.a,{to:"/"});var t=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"login"},r.a.createElement("header",{className:"login-header"},r.a.createElement("img",{src:w.a,alt:"logo"}),r.a.createElement("h1",null,"\u4e9a\u76dfREACT\u5168\u6808 \u2014 \u6570\u636e\u67e5\u8be2\u7cfb\u7edf")),r.a.createElement("section",{className:"login-content"},r.a.createElement("h2",null,"\u7528\u6237\u767b\u5f55"),r.a.createElement(O.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(Z,null,t("username",{rules:[{required:!0,whiteSpace:!0,message:"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c11\u56db\u4f4d"},{max:13,message:"\u7528\u6237\u540d\u4e0d\u80fd\u8d85\u8fc713\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d/\u5bc6\u7801\u5fc5\u987b\u662f\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"}]})(r.a.createElement(f.a,{prefix:r.a.createElement(g.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d"}))),r.a.createElement(O.a.Item,null,t("password",{rules:[{validator:this.validatorPWD}]})(r.a.createElement(f.a,{prefix:r.a.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u5bc6\u7801"}))),r.a.createElement(O.a.Item,null,r.a.createElement(h.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"\u767b\u5f55")))))}}]),t}(n.Component),ee=O.a.create()($),te=(a(722),a(175)),ae=(a(724),a(148)),ne=(a(727),[{title:"\u9996\u9875",key:"/home",icon:"home",isPublic:!0},{title:"\u5546\u54c1",key:"/product",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]},{title:"\u8ba2\u5355\u7ba1\u7406",key:"/order",icon:"windows"}]),re=ae.a.SubMenu,oe=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).hasRoleAuthorized=function(e){var t=e.key,a=e.isPublic,n=j.user.role.menus;return!("admin"!==j.user.username&&!a&&-1===n.indexOf(t))||!!e.children&&!!e.children.find((function(e){return-1!==n.indexOf(e.key)}))},a.getMenuNodes=function(e){var t=a.props.location.pathname;return e.reduce((function(e,n){a.hasRoleAuthorized(n)&&(n.children?(n.children.find((function(e){return 0===t.indexOf(e.key)}))&&(a.openKey=n.key),e.push(r.a.createElement(re,{key:n.key,title:r.a.createElement("span",null,r.a.createElement(g.a,{type:n.icon}),r.a.createElement("span",null,n.title))},a.getMenuNodes(n.children)))):e.push(r.a.createElement(ae.a.Item,{key:n.key},r.a.createElement(p.b,{to:n.key},r.a.createElement(g.a,{type:n.icon}),r.a.createElement("span",null,n.title)))));return e}),[])},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(ne)}},{key:"render",value:function(){var e=this.props.location.pathname;console.log("leftNav-render()",e),0===e.indexOf("/product")&&(e="/product");var t=this.openKey;return r.a.createElement("div",{className:"left-nav"},r.a.createElement(p.b,{to:"/",className:"left-nav-header"},r.a.createElement("img",{src:w.a,alt:"logo"}),r.a.createElement("h1",null,"\u6570\u636e\u540e\u53f0")),r.a.createElement(ae.a,{mode:"inline",theme:"dark",selectedKeys:[e],defaultOpenKeys:[t]},this.menuNodes))}}]),t}(n.Component),ce=Object(d.g)(oe),le=(a(183),a(72)),se=a(167);a(736);function ie(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}a(737);function ue(e){return r.a.createElement("button",Object.assign({},e,{className:"link-button"}))}var me=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={currentTime:ie(Date.now()),dayPictureUrl:"",weather:"",temperature:""},a.getCurrentTime=function(){a.intervalID=setInterval((function(){var e=ie(Date.now());a.setState({currentTime:e})}),1e3)},a.getWeather=Object(E.a)(b.a.mark((function e(){var t,n,r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R("\u8861\u6c34");case 2:t=e.sent,n=t.dayPictureUrl,r=t.weather,o=t.temperature,a.setState({dayPictureUrl:n,weather:r,temperature:o});case 7:case"end":return e.stop()}}),e)}))),a.getTitle=function(){var e,t=a.props.location.pathname;return ne.forEach((function(a){if(a.key===t)e=a.title;else if(a.children){var n=a.children.find((function(e){return 0===t.indexOf(e.key)}));n&&(e=n.title)}})),e},a.logout=function(){le.a.confirm({title:"\u786e\u5b9a\u9000\u51fa\u5417\uff1f",onOk:function(){console.log("OK",Object(se.a)(a)),I(),j.user={},a.props.history.replace("/login")}})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getCurrentTime(),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalID)}},{key:"render",value:function(){var e=this.state,t=e.currentTime,a=e.dayPictureUrl,n=e.weather,o=e.temperature,c=j.user.username,l=this.getTitle();return r.a.createElement("div",{className:"header-nav"},r.a.createElement("div",{className:"header-nav-top"},r.a.createElement("span",null,"\u6b22\u8fce\uff0c",c),r.a.createElement(ue,{onClick:this.logout},"\u9000\u51fa")),r.a.createElement("div",{className:"header-nav-bottom"},r.a.createElement("div",{className:"header-nav-bottom-left"},l),r.a.createElement("div",{className:"header-nav-bottom-right"},r.a.createElement("span",null,t),r.a.createElement("img",{src:a,alt:"weather"}),r.a.createElement("span",{className:"city"},"\u8861\u6c34"),r.a.createElement("span",null,n),r.a.createElement("span",null,o))))}}]),t}(n.Component),pe=Object(d.g)(me),de=(a(738),a(177)),he=(a(98),a(39)),fe=(a(742),a(270)),ge=(a(1259),a(558)),ye=a(26),be=a.n(ye),ve=a(67),Ee=a(548),Oe=a.n(Ee),ke=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=(new Oe.a).createView().source([{month:"Jan",a:7,b:3.9,c:5.9},{month:"Feb",a:6.9,b:4.2,c:1.9},{month:"Mar",a:9.5,b:5.7,c:3.9},{month:"Apr",a:14.5,b:8.5,c:5.5},{month:"May",a:18.4,b:11.9,c:8.9},{month:"Jun",a:21.5,b:15.2,c:10},{month:"Jul",a:25.2,b:17,c:12.9},{month:"Aug",a:26.5,b:16.6,c:15.9},{month:"Sep",a:23.3,b:14.2,c:20.7},{month:"Oct",a:18.3,b:10.3,c:25.9},{month:"Nov",a:13.9,b:6.6,c:30.9},{month:"Dec",a:9.6,b:4.8,c:35.9}]);e.transform({type:"fold",fields:["a","b","c"],key:"city",value:"temperature"});return r.a.createElement("div",{style:{float:"right",width:1050,height:400,paddingRight:150}},r.a.createElement(ve.Chart,{height:250,data:e,scale:{month:{range:[0,1]}},forceFit:!0},r.a.createElement(ve.Legend,null),r.a.createElement(ve.Axis,{name:"month"}),r.a.createElement(ve.Axis,{name:"temperature",label:{formatter:function(e){return"".concat(e,"\u4e07\u4e2a")}}}),r.a.createElement(ve.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(ve.Geom,{type:"line",position:"month*temperature",size:2,color:"city",shape:"smooth"}),r.a.createElement(ve.Geom,{type:"point",position:"month*temperature",size:4,shape:"circle",color:"city",style:{stroke:"#fff",lineWidth:1}})))}}]),t}(n.Component),we=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",marginLeft:-30}},r.a.createElement(ve.Chart,{height:338,data:[{year:"1\u6708",sales:38},{year:"2\u6708",sales:52},{year:"3\u6708",sales:61},{year:"4\u6708",sales:145},{year:"5\u6708",sales:48},{year:"6\u6708",sales:38},{year:"7\u6708",sales:28},{year:"8\u6708",sales:38},{year:"59\u6708",sales:68},{year:"10\u6708",sales:38},{year:"11\u6708",sales:58},{year:"12\u6708",sales:38}],scale:{sales:{tickInterval:20}},forceFit:!0},r.a.createElement(ve.Axis,{name:"year"}),r.a.createElement(ve.Axis,{name:"sales"}),r.a.createElement(ve.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(ve.Geom,{type:"interval",position:"year*sales"})))}}]),t}(n.Component),je=(a(747),ge.a.RangePicker),Ce=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isVisited:!0},a.handleChange=function(e){return function(){return a.setState({isVisited:e})}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.isVisited;return r.a.createElement("div",{className:"home"},r.a.createElement(he.a,{className:"home-card",title:"\u5546\u54c1\u603b\u91cf",extra:r.a.createElement(g.a,{style:{color:"rgba(0,0,0,.45)"},type:"question-circle"}),style:{width:250},headStyle:{color:"rgba(0,0,0,.45)"}},r.a.createElement(fe.a,{value:1128163,suffix:"\u4e2a",style:{fontWeight:"bolder"}}),r.a.createElement(fe.a,{value:15,valueStyle:{fontSize:15},prefix:"\u5468\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(g.a,{style:{color:"red",marginLeft:10},type:"arrow-down"}))}),r.a.createElement(fe.a,{value:10,valueStyle:{fontSize:15},prefix:"\u65e5\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(g.a,{style:{color:"#3f8600",marginLeft:10},type:"arrow-up"}))})),r.a.createElement(ke,null),r.a.createElement(he.a,{className:"home-content",title:r.a.createElement("div",{className:"home-menu"},r.a.createElement("span",{className:e?"home-menu-active home-menu-visited":"home-menu-visited",onClick:this.handleChange(!0)},"\u8bbf\u95ee\u91cf"),r.a.createElement("span",{className:e?"":"home-menu-active",onClick:this.handleChange(!1)},"\u9500\u552e\u91cf")),extra:r.a.createElement(je,{defaultValue:[be()("2019/01/01","YYYY/MM/DD"),be()("2019/06/01","YYYY/MM/DD")],format:"YYYY/MM/DD"})},r.a.createElement(he.a,{className:"home-table-left",title:e?"\u8bbf\u95ee\u8d8b\u52bf":"\u9500\u552e\u8d8b\u52bf",bodyStyle:{padding:0,height:275},extra:r.a.createElement(g.a,{type:"reload"})},r.a.createElement(we,null)),r.a.createElement(he.a,{title:"\u4efb\u52a1",extra:r.a.createElement(g.a,{type:"reload"}),className:"home-table-right"},r.a.createElement(de.a,null,r.a.createElement(de.a.Item,{color:"green"},"\u65b0\u7248\u672c\u8fed\u4ee3\u4f1a"),r.a.createElement(de.a.Item,{color:"green"},"\u5b8c\u6210\u7f51\u7ad9\u8bbe\u8ba1\u521d\u7248"),r.a.createElement(de.a.Item,{color:"red"},r.a.createElement("p",null,"\u8054\u8c03\u63a5\u53e3"),r.a.createElement("p",null,"\u529f\u80fd\u9a8c\u6536")),r.a.createElement(de.a.Item,null,r.a.createElement("p",null,"\u767b\u5f55\u529f\u80fd\u8bbe\u8ba1"),r.a.createElement("p",null,"\u6743\u9650\u9a8c\u8bc1"),r.a.createElement("p",null,"\u9875\u9762\u6392\u7248"))))))}}]),t}(n.Component),Se=(a(252),a(120)),xe=(a(222),a(66)),Ne=O.a.Item,Ie=xe.a.Option,Me=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props,t=e.categorys,a=e.parentId,n=this.props.form.getFieldDecorator;return r.a.createElement(O.a,null,r.a.createElement(Ne,null,n("parentId",{initialValue:a})(r.a.createElement(xe.a,null,r.a.createElement(Ie,{value:"0"},"\u4e00\u7ea7\u5206\u7c7b"),t.map((function(e){return r.a.createElement(Ie,{value:e._id},e.name)}))))),r.a.createElement(Ne,null,n("categoryName",{initialValue:"",rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(f.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component),Ae=O.a.create()(Me),Pe=O.a.Item,Te=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.categoryName,t=this.props.form.getFieldDecorator;return r.a.createElement(O.a,null,r.a.createElement(Pe,null,t("categoryName",{initialValue:e,rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(f.a,{placeholder:"\u8bf7\u8f93\u5165\u4fee\u6539\u7684\u5185\u5bb9"}))))}}]),t}(n.Component),De=O.a.create()(Te),_e=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={categorys:[],subCategorys:[],loading:!1,parentId:"0",parentName:"",showStatus:0},a.initColumns=function(){a.columns=[{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name"},{title:"\u64cd\u4f5c",width:300,render:function(e){return r.a.createElement("span",null,r.a.createElement(ue,{onClick:function(){return a.showUpdate(e)}},"\u4fee\u6539\u5206\u7c7b"),"0"===a.state.parentId?r.a.createElement(ue,{onClick:function(){a.showSubCategorys(e)}},"\u67e5\u770b\u5b50\u5206\u7c7b"):null)}}]},a.getCategorys=function(){var e=Object(E.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t=t||a.state.parentId,console.log("parentId-v:",t),e.next=5,z(t);case 5:n=e.sent,a.setState({loading:!1}),0===n.status?(r=n.data,"0"===t?(console.log("sub\u7b2c1\u6b21\uff1a","5e513c09ec5b28bbb5a7adc3"===t),a.setState({categorys:r})):(console.log("sub\u7b2c3\u6b21\uff1a","5e513c09ec5b28bbb5a7adc3"===t),a.setState({subCategorys:r}),console.log("\u7b2c4\u6b21",a.state.subCategorys,a.state.categorys),console.log("\u5bf9\u6bd45",a.state.subCategorys===a.state.categorys))):v.a.error("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u5931\u8d25");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.showSubCategorys=function(e){a.setState({parentId:e._id,parentName:e.name},(function(){console.log("sub\u7b2c2\u6b21\uff1a","5e513c09ec5b28bbb5a7adc3"===a.state.parentId),console.log("showSubCategorys():",typeof a.state.parentId===typeof a.state.parentName),a.getCategorys()}))},a.showCategorys=function(){a.setState({parentId:"0",parentName:"",subCategorys:[]})},a.handleCancel=function(){a.form.resetFields(),a.setState({showStatus:0})},a.showAdd=function(){a.setState({showStatus:1})},a.addCategory=function(){console.log("addCategory()1"),a.form.validateFields(function(){var e=Object(E.a)(b.a.mark((function e(t,n){var r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=9;break}return console.log("addCategory()2"),a.setState({showStatus:0}),r=n.parentId,o=n.categoryName,a.form.resetFields(),e.next=7,U(o,r);case 7:0===e.sent.status&&(r===a.state.parentId?a.getCategorys():"0"===r&&a.getCategorys("0"));case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.showUpdate=function(e){a.category=e,a.setState({showStatus:2})},a.updateCategory=function(){console.log("updateCategory()"),a.form.validateFields(function(){var e=Object(E.a)(b.a.mark((function e(t,n){var r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=9;break}return a.setState({showStatus:0}),r=a.category._id,o=n.categoryName,a.form.resetFields(),e.next=7,L({categoryId:r,categoryName:o});case 7:0===e.sent.status&&a.getCategorys();case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getCategorys()}},{key:"render",value:function(){var e=this,t=this.state,a=t.categorys,n=t.subCategorys,o=t.parentId,c=t.parentName,l=t.showStatus,s=t.loading,i=this.category||{},u="0"===o?"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868":r.a.createElement("span",null,r.a.createElement(ue,{onClick:this.showCategorys},"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868"),r.a.createElement(g.a,{type:"arrow-right",style:{marginRight:10}}),r.a.createElement("span",null,c)),m=r.a.createElement(h.a,{type:"primary",onClick:this.showAdd},r.a.createElement(g.a,{type:"plus"}),"\u6dfb\u52a0");return r.a.createElement(he.a,{title:u,extra:m},r.a.createElement(Se.a,{bordered:!0,rowKey:"_id",loading:s,dataSource:"0"===o?a:n,columns:this.columns,pagination:{defaultPageSize:5,showQuickJumper:!0}}),";",r.a.createElement(le.a,{title:"\u6dfb\u52a0\u5206\u7c7b",visible:1===l,onOk:this.addCategory,onCancel:this.handleCancel},r.a.createElement(Ae,{categorys:a,parentId:o,setForm:function(t){e.form=t}})),r.a.createElement(le.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===l,onOk:this.updateCategory,onCancel:this.handleCancel},r.a.createElement(De,{categoryName:i.name,setForm:function(t){e.form=t}})))}}]),t}(n.Component),Fe=xe.a.Option,Re=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={total:0,products:[],loading:!1,searchName:"",searchType:"productName"},a.initColumns=function(){a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\uffe5"+e}},{width:100,title:"\u72b6\u6001",render:function(e){var t=e.status,n=e._id,o=1===t?2:1;return r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",onClick:function(){return a.updateProductStatus(n,o)}},1===t?"\u5728\u552e":"\u4e0a\u67b6"),r.a.createElement("span",null,1===t?"\u5728\u552e":"\u5df2\u4e0b\u67b6"))}},{width:200,title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(ue,{onClick:function(){return a.props.history.push("/product/detail",{product:e})}},"\u67e5\u770b\u8be6\u60c5"),r.a.createElement(ue,{onClick:function(){return a.props.history.push("/product/add-update",e)}},"\u4fee\u6539"))}}]},a.getProducts=function(){var e=Object(E.a)(b.a.mark((function e(t){var n,r,o,c,l,s,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.pageNum=t,a.setState({loading:!0}),n=a.state,r=n.searchName,o=n.searchType,!r){e.next=9;break}return e.next=6,W({pageNum:t,pageSize:3,searchName:r,searchType:o});case 6:c=e.sent,e.next=12;break;case 9:return e.next=11,V(t,3);case 11:c=e.sent;case 12:a.setState({loading:!1}),0===c.status&&(l=c.data,s=l.total,i=l.list,a.setState({total:s,products:i}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.updateProductStatus=function(){var e=Object(E.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t,n);case 2:0===e.sent.status&&(1===n?v.a.success("\u66f4\u65b0\u5546\u54c1\u72b6\u6001\u6210\u529f\uff01\u53ef\u4ee5\u9500\u552e\u4e86"):v.a.success("\u66f4\u65b0\u5546\u54c1\u72b6\u6001\u6210\u529f\uff01\u5df2\u7981\u6b62\u9500\u552e"),a.getProducts(a.pageNum));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.state,a=t.products,n=t.total,o=t.loading,c=t.searchType,l=t.searchName,s=r.a.createElement("span",null,r.a.createElement(xe.a,{value:c,style:{width:150},onChange:function(t){e.setState({searchType:t})}},r.a.createElement(Fe,{value:"productName"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(Fe,{value:"productDesc"},"\u6309\u63cf\u8ff0\u641c\u7d22")),r.a.createElement(f.a,{value:l,placeholder:"\u5173\u952e\u5b57",style:{width:200,margin:"0 15px"},onChange:function(t){return e.setState({searchName:t.target.value})}}),r.a.createElement(h.a,{type:"primary",onClick:function(){e.getProducts(1)}},"\u641c\u7d22")),i=r.a.createElement(h.a,{type:"primary",onClick:function(){return e.props.history.push("/product/add-update")}},r.a.createElement(g.a,{type:"plus"}),"\u6dfb\u52a0\u5546\u54c1");return r.a.createElement(he.a,{title:s,extra:i},r.a.createElement(Se.a,{bordered:!0,rowKey:"_id",loading:o,dataSource:a,columns:this.columns,pagination:{total:n,defaultPageSize:3,showQuickJumper:!0,onChange:this.getProducts,current:this.pageNum}}))}}]),t}(n.Component),ze=(a(815),a(560)),Ue=a(205),Le=(a(1260),a(559)),Ve=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={previewVisible:!1,previewImage:"",fileList:[]},a.getImgs=function(){return a.state.fileList.map((function(e){return e.name}))},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(E.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,a.getBase64(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(E.a)(b.a.mark((function e(t){var n,r,o,c,l,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,console.log("handleChange()",n,n.status,r.length,"\u975e\u6307\u5411\u540c\u4e00\u4e2a\u5bf9\u8c61\uff1a",n===r[r.length-1]),"done"!==n.status){e.next=7;break}0===(o=n.response).status?(v.a.success("\u4e0a\u4f20\u56fe\u7247\u6210\u529f\uff01"),c=o.data,l=c.name,s=c.url,(n=r[r.length-1]).name=l,n.url=s,console.log("\u975e\u6307\u5411\u540c\u4e00\u4e2a\u5bf9\u8c612\uff1a",n===r[r.length-1])):v.a.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25"),e.next=12;break;case 7:if("removed"!==n.status){e.next=12;break}return e.next=10,q(n.name);case 10:0===e.sent.status?v.a.success("\u5220\u9664\u56fe\u7247\u6210\u529f"):v.a.error("\u5220\u9664\u56fe\u7247\u5931\u8d25");case 12:a.setState({fileList:r});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var n=[],r=a.props.imgs;return r&&r.length>0&&(n=r.map((function(e,t){return{uid:-t,name:e,status:"done",url:"http://localhost:5000/upload/"+e}}))),a.state={previewVisible:!1,previewImage:"",fileList:n},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getBase64",value:function(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}},{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,o=r.a.createElement("div",null,"\u70b9\u51fb\u4e0a\u4f20");return r.a.createElement("div",null,r.a.createElement(Le.a,{action:"/manager/img/upload",accept:"image/*",listType:"picture-card",name:"image",fileList:n,onPreview:this.handlePreview,onChange:this.handleChange},n.length>=6?null:o),r.a.createElement(le.a,{visible:t,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}]),t}(n.Component),We=a(121),Be=a(554),Ke=a(555),qe=a.n(Ke),Ye=a(556),Je=a.n(Ye),Ge=(a(946),function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={editorState:We.EditorState.createEmpty()},a.onEditorStateChange=function(e){console.log("onEditorStateChange()",e),a.setState({editorState:e})},a.getDetails=function(){return qe()(Object(We.convertToRaw)(a.state.editorState.getCurrentContent()))},a.uploadImageCallBack=function(e){return new Promise((function(t,a){var n=new XMLHttpRequest;n.open("POST","/manager/img/upload");var r=new FormData;r.append("image",e),n.send(r),n.addEventListener("load",(function(){var e=JSON.parse(n.responseText).data.url;console.log("response url: ",e),t({data:{link:e}})})),n.addEventListener("error",(function(){var e=JSON.parse(n.responseText);console.log("\u4e0a\u4f20\u5931\u8d25"),a(e)}))}))};var n=a.props.details;if(n){var r=Je()(n),o=We.ContentState.createFromBlockArray(r.contentBlocks),c=We.EditorState.createWithContent(o);a.state={editorState:c}}else a.state={editorState:We.EditorState.createEmpty()};return a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.editorState;return(r.a.createElement(Be.Editor,{editorState:e,editorStyle:{border:"1px solid black",minHeight:200,paddingLeft:10},onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0},inputAccept:"image/png,image/jpg,image/jpeg,image/svg,img/gif"}}}))}}]),t}(n.Component)),He=O.a.Item,Qe=f.a.TextArea,Xe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={options:[]},a.submit=function(){a.props.form.validateFields(function(){var e=Object(E.a)(b.a.mark((function e(t,n){var r,o,c,l,s,i,u,m,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=14;break}return console.log("submit():",n),r=n.name,o=n.desc,c=n.price,1===(l=n.categoryIds).length?(s="0",i=l[0]):(s=l[0],i=l[1]),u=a.creaters.current.getImgs(),m=a.editors.current.getDetails(),console.log("creater-imgs ",u,"-details: ",m,i,s),p={name:r,desc:o,price:c,imgs:u,detail:m,pCategoryId:s,categoryId:i},console.log("pCategoryId",s,"categoryId: ",i),a.isUpdate&&(p._id=a.product._id),e.next=12,Y(p);case 12:0===e.sent.status?(v.a.success("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u6210\u529f\uff01")),a.props.history.goBack()):v.a.error("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u5931\u8d25\uff01"));case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.validatorPrice=function(e,t,a){console.log(t,typeof t),1*t>0?a():a("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0")},a.initOptions=function(){var e=Object(E.a)(b.a.mark((function e(t){var n,r,o,c,l,s,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),r=Object(se.a)(a),o=r.isUpdate,c=r.product,l=c.pCategoryId,!o||"0"===l){e.next=10;break}return e.next=6,a.getCategorys(l);case 6:s=e.sent,i=s.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.find((function(e){return e.value===l})).children=i;case 10:a.setState({options:n});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getCategorys=function(){var e=Object(E.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t);case 2:if(0!==(n=e.sent).status){e.next=10;break}if(r=n.data,"0"!==t){e.next=9;break}a.initOptions(r),e.next=10;break;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadData=function(){var e=Object(E.a)(b.a.mark((function e(t){var n,r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,a.getCategorys(n.value);case 4:r=e.sent,n.loading=!1,r&&r.length>0?(o=r.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.children=o):n.isLeaf=!0,a.setState({options:Object(Ue.a)(a.state.options)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.creaters=r.a.createRef(),a.editors=r.a.createRef(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"componentWillMount",value:function(){var e=this.props.location.state;this.isUpdate=!!e,this.product=e||{}}},{key:"render",value:function(){var e=this,t=this.isUpdate,a=this.product,n=a.pCategoryId,o=a.categoryId,c=a.imgs,l=a.detail,s=[];t&&("0"===n?s.push(o):(s.push(n),s.push(o)));var i=r.a.createElement("span",null,r.a.createElement(ue,{onClick:function(){return e.props.history.goBack()}},r.a.createElement(g.a,{type:"arrow-left",style:{color:"green",marginRight:15,fontSize:20}})),r.a.createElement("span",{className:"products-title"},t?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1")),u=this.props.form.getFieldDecorator;return r.a.createElement(he.a,{title:i},r.a.createElement(O.a,{labelCol:{span:3},wrapperCol:{span:9}},r.a.createElement(He,{label:"\u5546\u54c1\u540d\u79f0\uff1a"},u("name",{initialValue:a.name,rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u540d\u79f0"}]})(r.a.createElement(f.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}))),r.a.createElement(He,{label:"\u5546\u54c1\u63cf\u8ff0\uff1a"},u("desc",{initialValue:a.desc,rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"}]})(r.a.createElement(Qe,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autoSize:{minRows:2,maxRows:8}}))),r.a.createElement(He,{label:"\u5546\u54c1\u4ef7\u683c\uff1a"},u("price",{initialValue:a.price,rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u4ef7\u683c"},{validator:this.validatorPrice}]})(r.a.createElement(f.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"}))),r.a.createElement(He,{label:"\u5546\u54c1\u5206\u7c7b\uff1a"},u("categoryIds",{initialValue:s,rules:[{required:!0,message:"\u5fc5\u987b\u9009\u62e9\u5546\u54c1\u5206\u7c7b"}]})(r.a.createElement(ze.a,{placeholder:"\u8bf7\u6307\u5b9a\u5546\u54c1\u5206\u7c7b",options:this.state.options,loadData:this.loadData}))),r.a.createElement(He,{label:"\u5546\u54c1\u56fe\u7247\uff1a"},r.a.createElement(Ve,{ref:this.creaters,imgs:c})),r.a.createElement(He,{label:"\u5546\u54c1\u8be6\u60c5\uff1a",labelCol:{span:3},wrapperCol:{span:18}},r.a.createElement(Ge,{ref:this.editors,details:l})),r.a.createElement(He,null,r.a.createElement(h.a,{type:"primary",onClick:this.submit},"\u63d0\u4ea4"))))}}]),t}(n.Component),Ze=O.a.create()(Xe),$e=(a(947),a(357)),et=$e.a.Item,tt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={categoryName1:"",categoryName2:""},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(E.a)(b.a.mark((function e(){var t,a,n,r,o,c,l,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.location.state.product,a=t.pCategoryId,n=t.categoryId,"0"!==a){e.next=9;break}return e.next=4,B(n);case 4:r=e.sent,o=r.data.name,this.setState({categoryName1:o}),e.next=15;break;case 9:return e.next=11,Promise.all([B(a),B(n)]);case 11:c=e.sent,l=c[0].data.name,s=c[1].data.name,this.setState({categoryName1:l,categoryName2:s});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.location.state.product,a=t.name,n=t.price,o=t.desc,c=t.detail,l=t.imgs,s=this.state,i=s.categoryName1,u=s.categoryName2,m=r.a.createElement("span",null,r.a.createElement(ue,null,r.a.createElement(g.a,{type:"arrow-left",style:{color:"green",marginRight:15,fontSize:20},onClick:function(){e.props.history.goBack()}})),r.a.createElement("span",{className:"products-title"},"\u5546\u54c1\u8be6\u60c5"));return r.a.createElement(he.a,{title:m,className:"products-detail"},r.a.createElement($e.a,null,r.a.createElement(et,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u540d\u79f0\uff1a"),a),r.a.createElement(et,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u63cf\u8ff0\uff1a"),o),r.a.createElement(et,null,r.a.createElement("span",{className:"left"},"\u4ef7\u683c\uff1a",n)),r.a.createElement(et,null,r.a.createElement("span",{className:"left"},"\u6240\u5c5e\u5206\u7c7b\uff1a"),i," ",u?" ---\x3e "+u:""),r.a.createElement(et,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u56fe\u7247\uff1a",l.map((function(e){return r.a.createElement("img",{alt:"\u5546\u54c1\u56fe\u7247",className:"product-img",key:e,src:"http://localhost:5000/upload/"+e})}))),r.a.createElement("span",{style:{float:"left"}})),r.a.createElement(et,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u8be6\u60c5",r.a.createElement("span",{dangerouslySetInnerHTML:{__html:c}})))))}}]),t}(n.Component),at=(a(949),function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/product",component:Re,exact:!0}),r.a.createElement(d.b,{path:"/product/add-update",component:Ze}),r.a.createElement(d.b,{path:"/product/detail",component:tt}),r.a.createElement(d.a,{to:"/product"}))}}]),t}(n.Component)),nt=O.a.Item,rt=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(O.a,null,r.a.createElement(nt,Object.assign({label:"\u89d2\u8272\u540d\u79f0\uff1a"},{labelCol:{span:6},wrapperCol:{span:15}}),e("roleName",{initialValue:"",rules:[{required:!0,message:"\u89d2\u8272\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(f.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))))}}]),t}(n.Component),ot=O.a.create()(rt),ct=(a(950),a(356)),lt=O.a.Item,st=ct.a.TreeNode,it=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).getAuthorizedMenus=function(){return a.state.checkedKeys},a.getMenuTreeNodes=function(e){return e.reduce((function(e,t){return e.push(r.a.createElement(st,{title:t.title,key:t.key},t.children?a.getMenuTreeNodes(t.children):null)),e}),[])},a.onChecked=function(e){console.log("onChecked",e),a.setState({checkedKeys:e})};var n=a.props.role.menus;return a.state={checkedKeys:n},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.treeNodes=this.getMenuTreeNodes(ne)}},{key:"componentWillReceiveProps",value:function(e){console.log("componentWillReceiveProps(): ",e);var t=e.role.menus;this.setState({checkedKeys:t})}},{key:"render",value:function(){console.log("\u7b2c\u4e00\u6b21\u8c03\u7528render()");var e=this.props.role,t=this.state.checkedKeys;return r.a.createElement("div",null,r.a.createElement(lt,Object.assign({label:"\u89d2\u8272\u540d\u79f0\uff1a"},{labelCol:{span:6},wrapperCol:{span:15}}),r.a.createElement(f.a,{value:e.name,disabled:!0})),r.a.createElement(ct.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:t,onCheck:this.onChecked},r.a.createElement(st,{title:"\u5e73\u53f0\u6743\u9650",key:"all"},this.treeNodes)))}}]),t}(n.Component),ut=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={roles:[],role:{},isShowAddRoles:!1,isShowTreeAuthorized:!1},a.initColumns=function(){a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return ie(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:ie},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}]},a.getRoleList=Object(E.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T("/manager/role/list");case 2:0===(t=e.sent).status&&(n=t.data,a.setState({roles:n}));case 4:case"end":return e.stop()}}),e)}))),a.onRows=function(e){return{onClick:function(t){console.log("onRows()--\x3e ",e),a.setState({role:e})}}},a.addRoles=function(){a.form.validateFields(function(){var e=Object(E.a)(b.a.mark((function e(t,n){var r,o,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return a.setState({isShowAddRoles:!1}),r=n.roleName,a.form.resetFields(),e.next=6,J(r);case 6:0===(o=e.sent).status?(v.a.success("\u6dfb\u52a0\u89d2\u8272\u6210\u529f"),c=o.data,a.setState((function(e){return{roles:[].concat(Object(Ue.a)(e.roles),[c])}}))):v.a.error("\u6dfb\u52a0\u89d2\u8272\u5931\u8d25");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.updateAuthorized=Object(E.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isShowTreeAuthorized:!1}),t=a.state.role,n=a.authorized.current.getAuthorizedMenus(),t.menus=n,t.auth_time=Date.now(),t.auth_name=j.user.username,e.next=8,G(t);case 8:0===e.sent.status?t._id===j.user.role_id?(j.user={},I(),a.props.history.replace("./login"),v.a.success("\u5f53\u524d\u7528\u6237\u89d2\u8272\u5df2\u4fee\u6539\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01")):(v.a.success("\u8bbe\u7f6e\u89d2\u8272\u6743\u9650\u6210\u529f\uff01"),a.setState({roles:Object(Ue.a)(a.state.roles)})):v.a.error("\u8bbe\u7f6e\u89d2\u8272\u5931\u8d25\uff01");case 10:case"end":return e.stop()}}),e)}))),a.authorized=r.a.createRef(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getRoleList()}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.role,o=t.isShowAddRoles,c=t.isShowTreeAuthorized,l=r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",style:{marginRight:20},onClick:function(){return e.setState({isShowAddRoles:!0})}},"\u521b\u5efa\u89d2\u8272"),r.a.createElement(h.a,{type:"primary",disabled:!n._id,onClick:function(){return e.setState({isShowTreeAuthorized:!0})}},"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"));return r.a.createElement(he.a,{title:l},r.a.createElement(Se.a,{bordered:!0,rowKey:"_id",dataSource:a,columns:this.columns,pagination:{defaultPageSize:3,showQuickJumper:!0},rowSelection:{type:"radio",selectedRowKeys:[n._id],onSelect:function(t){e.setState({role:t})}},onRow:this.onRows}),r.a.createElement(le.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:o,onOk:this.addRoles,onCancel:function(){e.setState({isShowAddRoles:!1}),e.form.resetFields()}},r.a.createElement(ot,{setForm:function(t){e.form=t}})),r.a.createElement(le.a,{title:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650",visible:c,onOk:this.updateAuthorized,onCancel:function(){e.setState({isShowTreeAuthorized:!1})}},r.a.createElement(it,{role:n,ref:this.authorized})))}}]),t}(n.Component),mt=O.a.Item,pt=xe.a.Option,dt=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user,n=this.props.form.getFieldDecorator;return r.a.createElement(O.a,{labelCol:{span:6},wrapperCol:{span:15}},r.a.createElement(mt,{label:"\u7528\u6237\u540d\uff1a"},n("username",{initialValue:a.username,rules:[{required:!0,message:"\u7528\u6237\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(f.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u79f0"}))),a._id?null:r.a.createElement(mt,{label:"\u5bc6\u7801\uff1a"},n("password",{initialValue:a.password,rules:[{required:!0,message:"\u5bc6\u7801\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(f.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))),r.a.createElement(mt,{label:"\u624b\u673a\u53f7\uff1a"},n("phone",{initialValue:a.phone,rules:[{required:!0,message:"\u624b\u673a\u53f7\u7801\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(f.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801"}))),r.a.createElement(mt,{label:"\u90ae\u7bb1\uff1a"},n("email",{initialValue:a.email})(r.a.createElement(f.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"}))),r.a.createElement(mt,{label:"\u89d2\u8272\uff1a"},n("role_id",{initialValue:a.role_id,rules:[{required:!0,message:"\u89d2\u8272\u5fc5\u987b\u9009\u62e9"}]})(r.a.createElement(xe.a,{placeholder:"\u8bf7\u9009\u62e9"},t.map((function(e){return r.a.createElement(pt,{key:e._id,value:e._id},e.name)}))))))}}]),t}(n.PureComponent),ht=O.a.create()(dt),ft=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={users:[],roles:[],loading:!1,isShow:!1},a.initColumns=function(){a.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:ie},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(e){return a.rolesName[e]}},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(ue,{onClick:function(){return a.showUserUpdate(e)}},"\u4fee\u6539"),r.a.createElement(ue,{onClick:function(){return a.userDel(e)}},"\u5220\u9664"))}}]},a.initRolesName=function(e){var t=e.reduce((function(e,t){return e[t._id]=t.name,e}),{});a.rolesName=t},a.getUsers=Object(E.a)(b.a.mark((function e(){var t,n,r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:0===(t=e.sent).status&&(n=t.data,r=n.users,o=n.roles,a.initRolesName(o),a.setState({users:r,roles:o}));case 4:case"end":return e.stop()}}),e)}))),a.userDel=function(e){le.a.confirm({title:"\u786e\u8ba4\u5220\u9664 ".concat(e.username," \u5417\uff1f"),onOk:function(){var t=Object(E.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Q(e._id);case 2:0===t.sent.status&&(v.a.success("\u5220\u9664\u7528\u6237\u6210\u529f\uff01"),a.getUsers());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})},a.addUpdateUsers=Object(E.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isShow:!1}),t=a.form.getFieldsValue(),a.form.resetFields(),a.user&&(t._id=a.user._id),e.next=6,X(t);case 6:0===e.sent.status&&(v.a.success("".concat(a.user?"\u4fee\u6539":"\u6dfb\u52a0","\u7528\u6237\u6210\u529f\uff01")),a.getUsers());case 8:case"end":return e.stop()}}),e)}))),a.showUserAdd=function(){a.user=null,a.setState({isShow:!0})},a.showUserUpdate=function(e){a.user=e,a.setState({isShow:!0})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.isShow,o=t.loading,c=t.roles,l=this.user||{},s=r.a.createElement(h.a,{type:"primary",onClick:this.showUserAdd},"\u521b\u5efa\u7528\u6237");return r.a.createElement(he.a,{title:s},r.a.createElement(Se.a,{bordered:!0,rowKey:"_id",loading:o,dataSource:a,columns:this.columns,pagination:{defaultPageSize:3,showQuickJumper:!0}}),r.a.createElement(le.a,{title:l._id?"\u4fee\u6539\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:n,onOk:this.addUpdateUsers,onCancel:function(){e.form.resetFields(),e.setState({isShow:!1})}},r.a.createElement(ht,{setForm:function(t){return e.form=t},roles:c,user:l})))}}]),t}(n.Component),gt=a(146),yt=a.n(gt),bt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={saleMount:[5,20,36,10,10,20],storageMount:[10,19,50,5,15,10]},a.updateBar=function(){console.log("updateBar"),a.setState((function(e){return{saleMount:e.saleMount.map((function(e){return e+1})),storageMount:e.storageMount.reduce((function(e,t){return e.push(t-1),e}),[])}}))},a.getBarOption=function(e,t){return{title:{text:"ECharts \u9500\u552e\u6570\u636e"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e},{name:"\u5e93\u5b58",type:"bar",data:t}]}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.saleMount,a=e.storageMount;return r.a.createElement("div",null,r.a.createElement(he.a,null,r.a.createElement(h.a,{type:"primary",onClick:this.updateBar},"\u66f4\u65b0")),r.a.createElement(he.a,{title:"DATA-\u67f1\u72b6\u56fe\u4e00"},r.a.createElement(yt.a,{option:this.getBarOption(t,a)})))}}]),t}(n.Component),vt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={saleMount:[5,20,36,10,10,20],storageMount:[10,19,50,5,15,10]},a.updateLine=function(){console.log("updateLine"),a.setState((function(e){return{saleMount:e.saleMount.map((function(e){return e+1})),storageMount:e.storageMount.reduce((function(e,t){return e.push(t-1),e}),[])}}))},a.getLineOption=function(e,t){return{title:{text:"ECharts \u9500\u552e\u6570\u636e"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e},{name:"\u5e93\u5b58",type:"line",data:t}]}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.saleMount,a=e.storageMount;return r.a.createElement("div",null,r.a.createElement(he.a,null,r.a.createElement(h.a,{type:"primary",onClick:this.updateLine},"\u66f4\u65b0")),r.a.createElement(he.a,{title:"DATA-\u6298\u7ebf\u56fe\u4e8c"},r.a.createElement(yt.a,{option:this.getLineOption(t,a)})))}}]),t}(n.Component),Et=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).updatePie1=function(){console.log("updatePie"),a.setState((function(e){return{saleMount:e.saleMount.map((function(e){return e+1})),storageMount:e.storageMount.reduce((function(e,t){return e.push(t-1),e}),[])}}))},a.getPieOption1=function(){return{title:{text:"\u4e9a\u76df\u7ad9\u70b9\u7528\u6237\u8bbf\u95ee\u6765\u6e90",subtext:"\u7eaf\u5c5e\u865a\u6784",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["\u76f4\u63a5\u8bbf\u95ee","\u90ae\u4ef6\u8425\u9500","\u8054\u76df\u5e7f\u544a","\u89c6\u9891\u5e7f\u544a","\u641c\u7d22\u5f15\u64ce"]},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:234,name:"\u8054\u76df\u5e7f\u544a"},{value:135,name:"\u89c6\u9891\u5e7f\u544a"},{value:1548,name:"\u641c\u7d22\u5f15\u64ce"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},a.getPieOption2=function(){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:274,name:"\u8054\u76df\u5e7f\u544a"},{value:235,name:"\u89c6\u9891\u5e7f\u544a"},{value:400,name:"\u641c\u7d22\u5f15\u64ce"}].sort((function(e,t){return e.value-t.value})),roseType:"radius",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(he.a,null,r.a.createElement(h.a,{type:"primary",onClick:this.updatePie1},"\u66f4\u65b0")),r.a.createElement(he.a,{title:"DATA-\u997c\u72b6\u56fe\u4e00"},r.a.createElement(yt.a,{option:this.getPieOption1(),style:{height:300}})),r.a.createElement(he.a,{title:"DATA-\u997c\u72b6\u56fe\u4e8c"},r.a.createElement(yt.a,{option:this.getPieOption2(),style:{height:300}})))}}]),t}(n.Component),Ot=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"\u8ba2\u5355\u7ba1\u7406")}}]),t}(n.Component),kt=(a(391),a(123)),wt=(a(392),a(68)),jt=(a(1257),function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(kt.a,{className:"not-found"},r.a.createElement(wt.a,{span:12,className:"left"}),r.a.createElement(wt.a,{span:12,className:"right"},r.a.createElement("h1",null,"404"),r.a.createElement("h2",null,"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"),r.a.createElement("div",null,r.a.createElement(h.a,{type:"primary",onClick:function(){return e.props.history.replace("/home")}},"\u56de\u5230\u9996\u9875"))))}}]),t}(n.Component)),Ct=te.a.Footer,St=te.a.Sider,xt=te.a.Content,Nt=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=j.user;return e&&e._id?r.a.createElement(te.a,{style:{minHeight:"100%"}},r.a.createElement(St,null,r.a.createElement(ce,null)),r.a.createElement(te.a,null,r.a.createElement(pe,null,"Header"),r.a.createElement(xt,{style:{backgroundColor:"#fff",margin:30}},r.a.createElement(d.d,null,r.a.createElement(d.a,{from:"/",to:"/home",exact:!0}),r.a.createElement(d.b,{path:"/home",component:Ce}),r.a.createElement(d.b,{path:"/category",component:_e}),r.a.createElement(d.b,{path:"/product",component:at}),r.a.createElement(d.b,{path:"/role",component:ut}),r.a.createElement(d.b,{path:"/user",component:ft}),r.a.createElement(d.b,{path:"/charts/bar",component:bt}),r.a.createElement(d.b,{path:"/charts/line",component:vt}),r.a.createElement(d.b,{path:"/charts/pie",component:Et}),r.a.createElement(d.b,{path:"/order",component:Ot}),r.a.createElement(d.b,{component:jt}))),r.a.createElement(Ct,{style:{textAlign:"center",color:"#cccccc"}},"\u5373\u523b\u5f00\u542f\u4f60\u7684\u6570\u636e\u8ddf\u8e2a\u4e4b\u65c5 \u2014 @cevent\u63d0\u4f9b\u6280\u672f\u652f\u6301"))):r.a.createElement(d.a,{to:"/login"})}}]),t}(n.Component),It=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/login",component:ee}),r.a.createElement(d.b,{path:"/",component:Nt})))}}]),t}(n.Component),Mt=N();j.user=Mt,c.a.render(r.a.createElement(It,null),document.getElementById("root"))},254:function(e,t,a){e.exports=a.p+"static/media/\u4e9a\u76df.f071cb62.png"},562:function(e,t,a){e.exports=a(1258)},574:function(e,t,a){},727:function(e,t,a){},736:function(e,t,a){},737:function(e,t,a){},747:function(e,t,a){},949:function(e,t,a){}},[[562,1,2]]]);
//# sourceMappingURL=main.5152a28b.chunk.js.map